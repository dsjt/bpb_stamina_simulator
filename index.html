<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BackpackBattles スタミナ計算機</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>⚔️ BackpackBattles スタミナ計算機</h1>
            <p>武器構成のスタミナ切れタイミングを可視化</p>
        </header>

        <div class="content">
            <div class="inputs">
                <!-- 武器登録セクション -->
                <div class="section">
                  <div class="section-title">武器登録</div>
                  <select id="weaponPreset">
                    <option value="">プリセット選択...</option>
                    <option value="wooden_sword">木の剣 (CD: 1.4s, スタミナ: 1)</option>
                    <option value="bloom">ホウキ (CD: 1.7s, スタミナ: 1.2)</option>
                    <option value="pan">フライパン (CD: 2.2s, スタミナ: 2)</option>
                    <option value="short_bow">ショートボウ (CD: 1.7s, スタミナ: 0.7)</option>

                    <option value="torch">たいまつ (CD: 1.4s, スタミナ: 1)</option>
                    <option value="spear">スピア (CD: 1.5s, スタミナ: 1)</option>
                    <option value="hammer">ハンマー (CD: 2s, スタミナ: 3)</option>
                    <option value="totem">殻のトーテム (CD: 3.6s, スタミナ: 2)</option>
                    <option value="shovel">シャベル (CD: 2.4s, スタミナ: 1.7)</option>

                    <option value="attack_claw">アタッククロー (CD: 1.6s, スタミナ: 0.5)</option>
                    <option value="hungry_blade">飢えたる剣 (CD: 1.6s, スタミナ: 1)</option>
                    <option value="hero_sword">英雄の剣 (CD: 1.4s, スタミナ: 0.7)</option>

                  </select>
                  <button class="btn btn-primary btn-block" onclick="addWeapon()">+ 武器追加</button>
                  <div id="weaponList"></div>
                </div>

                <!-- スタミナアイテムセクション -->
                <div class="section">
                  <div class="section-title">スタミナアイテム</div>

                  <select id="itemPreset">
                    <option value="">アイテム選択...</option>
                    <option value="banana">バナナ (CD: 5s, 回復: 1)</option>
                    <option value="hero_potion">ヒーローポーション (回復: 2)</option>
                    <option value="stamina_bag">スタミナバッグ (最大値: +1)</option>
                    <option value="courage_star">勇気の星 (スタミナ消費: -5%)</option>
                    <option value="monkey_blacksmith">サルでもわかる鍛冶 (スタミナ消費: -25%)</option>
                  </select>
                  <button class="btn btn-primary btn-block" onclick="addItem()">+ アイテム追加</button>
                  <div id="itemList"></div>
                </div>

                <!-- その他のオプションセクション -->
                <div class="section">
                  <div class="section-title">その他のオプション</div>

                  <div class="checkbox-group">
                    <input type="checkbox" id="showHeatFreeze" onchange="toggleSection('heatFreezeSection', this.checked)">
                    <label for="showHeatFreeze">ヒート・フリーズ設定を表示</label>
                  </div>

                  <div class="checkbox-group">
                    <input type="checkbox" id="showPuzzleBox" onchange="toggleSection('puzzleBoxSection', this.checked)">
                    <label for="showPuzzleBox">パズルボックス設定を表示</label>
                  </div>
                </div>

                <!-- ヒート・フリーズセクション（初期非表示） -->
                <div class="section" id="heatFreezeSection" style="display: none;">
                  <div class="section-title">ヒート/フリーズ</div>

                  <div class="input-group">
                    <label>ヒート</label>
                    <input type="number" id="initialHeat" value="0" step="1" min="0">
                    <div class="info-text">ヒート1につきクールダウン2%短縮</div>
                  </div>

                  <div class="input-group">
                    <label>フリーズ</label>
                    <input type="number" id="freezeStacks" value="0" step="1" min="0">
                    <div class="info-text">フリーズ1につきクールダウン2%延長</div>
                  </div>
                </div>

                <!-- パズルボックスセクション（初期非表示） -->
                <div class="section" id="puzzleBoxSection" style="display: none;">
                  <div class="section-title">パズルボックス</div>

                  <div class="input-group">
                    <label>中に入れる武器</label>
                    <div id="puzzleBoxWeaponList" style="max-height: 120px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px; padding: 8px; background: #f8f9fa;">
                      <!-- 武器チェックボックスを動的生成 -->
                    </div>
                  </div>

                  <div class="input-group">
                    <label>中に入れるバナナ</label>
                    <div id="puzzleBoxBananaList" style="max-height: 120px; overflow-y: auto; border: solid #ddd; border-radius: 4px; padding: 8px; background: #f8f9fa;">
                      <!-- バナナチェックボックスを動的生成 -->
                    </div>
                  </div>

                  <div class="info-text">
                    0～5秒: 使用速度-20% (速度補正0.8倍)<br>
                    5秒以降: 使用速度+55% (速度補正1.55倍)
                  </div>
                </div>

                <!-- シミュレーション設定 -->
                <div class="section">
                    <div class="section-title">シミュレーション設定</div>
                    <div class="input-group">
                        <label>シミュレーション時間 (秒)</label>
                        <input type="number" id="simDuration" value="30" step="1" min="5" max="60">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="calculate()">計算実行</button>

                </div>
            </div>

            <div class="outputs">
                <!-- グラフ -->
                <div class="section">
                    <div class="section-title">スタミナ推移</div>
                    <canvas id="staminaChart"></canvas>
                </div>

                <!-- 分析結果 -->
                <div class="section">
                    <div class="section-title">分析結果</div>
                    <div id="analysisResults"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="script.js"></script>
</body>
</html>
